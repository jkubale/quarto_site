[{"name":"app.R","content":"\r\n\r\nlibrary(shiny)\r\nlibrary(ggplot2)\r\nset.seed(894)\r\n\r\nx = sort(rnorm(20, 5, 5))\r\ny = sort(rnorm(20, 5, 10))\r\nlmod = lm(y ~ x)\r\n\r\nsummary(lmod)\r\n\r\ndat <- data.frame(x = x, y = y)\r\n\r\nui <- fluidPage(\r\n  sidebarPanel(\r\n  sliderInput(\"intercept\", \"intercept\", min = -10, max = 10, value = lmod$coefficients[1],step=0.5),\r\n  sliderInput(\"slope\", \"slope\", min = 0.3, max = 5, value = lmod$coefficients[2], step=0.2)),\r\n  mainPanel(\r\n    plotOutput(\"plot\")\r\n  )\r\n)\r\nserver <- function(input, output, session) {\r\n  output$plot <- renderPlot(\r\n    width = 600,\r\n    height = 600,\r\n    res = 96,\r\n    {\r\n      ggplot(dat, aes(x = x, y = y)) + \r\n        geom_point() +\r\n        geom_abline(slope = input$slope, intercept = input$intercept) +\r\n        coord_fixed()+\r\n        geom_rect(inherit.aes = F, alpha = 0.2,\r\n                  aes(ymin = pmin(y, (input$intercept + (input$slope*x))), \r\n                      ymax = pmax(y, (input$intercept + (input$slope*x))), \r\n                      xmin = pmin(x, x - (y-(input$intercept + (input$slope*x)))),\r\n                      xmax = pmax(x, x - (y-(input$intercept + (input$slope*x))))))\r\n    }\r\n  )\r\n}\r\n\r\n# Run the application \r\nshinyApp(ui = ui, server = server)\r\n","type":"text"}]
